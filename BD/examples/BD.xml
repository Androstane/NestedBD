<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus=''
       namespace="beast.core:beast.evolution.alignment:beast.evolution.tree:beast.evolution.speciation:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood"
       version="2.0">


<map name="Uniform">beast.math.distributions.Uniform</map>
    
<map name="Exponential">beast.math.distributions.Exponential</map>
    
<map name="LogNormal">beast.math.distributions.LogNormalDistributionModel</map>
    
<map name="Normal">beast.math.distributions.Normal</map>
    
<map name="Beta">beast.math.distributions.Beta</map>
    
<map name="Gamma">beast.math.distributions.Gamma</map>
    
<map name="LaplaceDistribution">beast.math.distributions.LaplaceDistribution</map>
    
<map name="prior">beast.math.distributions.Prior</map>

<data id="CNAprofile" dataType="integer">
<sequence taxon="diploid1">
            1,2,2
        </sequence>
<sequence taxon="diploid2">
            2,2,2
        </sequence>
<sequence taxon="leaf1">
            2,2,5
        </sequence>
<sequence taxon="leaf2">
            2,2,5
        </sequence>
<sequence taxon="leaf3">
            3,2,6
        </sequence>
<sequence taxon="leaf5">
            5,2,2
        </sequence>
</data>


<distribution id="posterior" spec="util.CompoundDistribution">
	<distribution id="prior" spec="util.CompoundDistribution">
	
	
		<distribution conditionalOnRoot="false" id="YuleModel" spec="YuleModel" tree="@Tree">
			<parameter estimate="false" id="birthRate" name="birthDiffRate" value="1.0"/>
		</distribution>
		
		<prior id="OrigTimePrior" spec="beast.math.distributions.Prior" x="@OrigTime" name="distribution">
			<Uniform id="Uniform.62" name="distr"/>
		</prior>
		
	</distribution>



	<distribution id="likelihood" spec="util.CompoundDistribution">
		 <distribution id="DipOrigLikelihood" spec="DiploidOriginLikelihood" data="@CNAprofile" tree="@Tree" origtime = "@OrigTime">
			<!--<parameter id="OrigTime" spec="parameter.RealParameter" lower="0.0" name= "OrigTime" upper="1.0">0.0</parameter>-->
			<siteModel id="SiteModel" spec="SiteModel">
				<substModel id="BD" spec="beast.evolution.substitutionmodel.BD" nstates = "30">
				</substModel>
			</siteModel>
			<branchRateModel id="StrictClock" spec="beast.evolution.branchratemodel.StrictClockModel">
				<parameter estimate="false" id="clockRate" name="clock.rate" value="1.0"/>
		</branchRateModel>
		</distribution>
	</distribution>
</distribution>


<run chainLength="20" id="mcmc" preBurnin="0" spec="MCMC">
	<state id="state" storeEvery="1">
		<tree estimate="true" id="Tree" name="stateNode">
			<taxonset id="TaxonSet" spec="beast.evolution.alignment.TaxonSet">
				<data idref="CNAprofile" name="alignment"/>
			</taxonset>
		</tree>
		<parameter estimate="true" id="OrigTime" lower="0.0" name="stateNode" value="1.0"/>
	</state>

	<distribution idref="posterior"/>
	<operator degreesOfFreedom="1" id="treeScaler" scaleFactor="0.5" spec="beast.evolution.operators.ScaleOperator" tree="@Tree" weight="10.0"/>
	<operator id="UniformOperator" spec="beast.evolution.operators.Uniform" tree="@Tree" weight="10.0"/>
	<operator gaussian="true" id="SubtreeSlide" optimise="true" size="1.0" spec="beast.evolution.operators.SubtreeSlide" tree="@Tree" weight="10.0"/>
	<operator id="narrow" isNarrow="true" spec="beast.evolution.operators.Exchange" tree="@Tree" weight="10.0"/>
	<operator id="wide" isNarrow="false" spec="beast.evolution.operators.Exchange" tree="@Tree" weight="10.0"/>
	<operator id="WilsonBalding" spec="beast.evolution.operators.WilsonBalding" tree="@Tree" weight
	
	="10.0"/>
	<operator degreesOfFreedom="1" id="OrigTimeScaler" scaleFactor="0.5" spec="beast.evolution.operators.ScaleOperator" weight="10.0" parameter="@OrigTime"/>

	<logger fileName="beast.$(seed).log" id="tracelog" logEvery="1" model="@posterior">
	<log idref="posterior"/>
	<log idref="likelihood"/>
	
	<log idref="prior"/>
	<log id="TreeHeight" spec="TreeHeightLogger" tree="@Tree"/>
	<log idref="YuleModel"/>
	<log idref="OrigTime"/>
	</logger>
	<logger id="screenlog" logEvery="1">
	<log idref="posterior"/>
	<log arg="@posterior" id="ESS.0" spec="util.ESS"/>
	<log idref="likelihood"/>
	<log idref="prior"/>
	</logger>

	<logger fileName="beast.$(seed).trees" id="treelog" logEvery="10000" mode="tree">
	<log idref="Tree"/>
	</logger>



	<init id="RandomTree" initial="@Tree" spec="RandomTree" taxa="@CNAprofile">
		<populationModel id="ConstantPopulation" spec="ConstantPopulation">
			<parameter dimension="1" estimate="true" id="popSize" name="popSize" value="1"/>
		</populationModel>
	</init>
</run>

</beast>
